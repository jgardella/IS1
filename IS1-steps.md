This file serves as an introduction to the code base, and the process it facilitates.
See `readme.txt` for a more detailed explanation of the code base.

Overview
========
The code is used to perform analysis and generate models based on a folder of slice images. It can
perform the following operations:
- Channel Extraction: performs skeletonization on the input slices, in order to extract channels of a given minimum diameter
- Create PLY from SkeletonCSV: using the CSV output by Channel Extraction, creates a mesh showing the extracted channels
- Graph Analysis: using the graph MAT output by Channel Extraction, finds the shortest path through the graph and displays it
- Create ShortestPath PLY: using the graph MAT output by Channel Extraction, creates a mesh showing the shortest path through the graph

See the sections below for a more detailed explanation of each operation, and its associated source files.

Channel Extraction
==================
Input: slice images, maximum channel diameter
Output: resulting skeleton as CSV, resulting graph as MAT

1. Construct 3D matrix of occupied space from slice images. (`matlab/createMat.m`)
2. Dilate matrix using structuring element of maximum channel diameter. (`matlab/extractChannels.m`)
3. Skeletonize matrix using Skeleton3D library. (`matlab/extractChannels.m`)
4. Save resulting skeleton to CSV, and save graph to a MAT file. (`matlab.extractChannels.m`)

NOTE: this whole process is done by `matlab/extractChannelsFromSlices.m`)

Create PLY from SkeletonCSV
===========================
Input: skeleton CSV from Channel Extraction, X dimension of CSV, Y dimension of CSV, Z dimension of CSV,
       Red value for ply, Green value for ply, Blue value for ply,
       X origin point of bacteria mesh, Y origin point of bacteria mesh, Z origin point of bacteria mesh,
       scale factor between ply and bacteria mesh
Output: ply representation of CSV

Use C++ main `skel_main.cpp`.

NOTE: `extract.sh` script combines Channel Extraction and Create PLY from SkeletonCSV

Graph Analysis
==============
Input: graph MAT from Channel Extraction

`matlab/displayGraph.m` will calculate the shortest path through the graph,
and then display the graph with the path overlayed in green, and the start and end nodes in magneta.

The shortest path is found by taking the top 5% and bottom 5% of the nodes in the graph, and then
running dijkstra's algorithm on every combination of start and end nodes, keeping the path
of minimum cost. See `matlab/shortestPath.m` for the source.

Since the result of display graph has a very large number of nodes, it is very difficult to view it.
See Create ShortestPath PLY for a more useful representation of the shortest path.

Create ShortestPath PLY
=======================
Input: graph MAT from Channel Extraction,
       Red value for ply, Green value for ply, Blue value for ply,
       scaling factor between ply and bacteria mesh,
       X origin point of bacteria mesh, Y origin point of bacteria mesh, Z origin point of bacteria mesh
Output: ply representation of shortest path

`matlab/saveShortestPath.m` saves the shortest path computed from Graph Analysis to a ply so it can be overlayed
with the original bacteria mesh, or with the skeleton ply generated by `extract.sh`.
